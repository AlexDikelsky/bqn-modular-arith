mod â† â€¢Import "mod.bqn"

Xgcd â† mod.Xgcd
ModInverse â† mod.ModInverse
ZCross â† mod.ZCross

! (1 Xgcd 5) â‰¡ âŸ¨1, 1, 0âŸ©
! (2 Xgcd 5) â‰¡ âŸ¨1, -2, 1âŸ©
! (3 Xgcd 5) â‰¡ âŸ¨1, 2, -1âŸ©
! (4 Xgcd 5) â‰¡ âŸ¨1, -1, 1âŸ©

! (0 Xgcd 0) â‰¡ âŸ¨0, 0, 0âŸ©

! (100 Xgcd 100) â‰¡ âŸ¨100, 1, 0âŸ©
! (23 Xgcd 23) â‰¡ âŸ¨23, 1, 0âŸ©

size â† 40
identityMatrix â† =âŒœËœâ†•size
postable â† XgcdâŒœËœâ†•size
negTable â† - posTable
posNegNums â† (sizeÃ·2)-â†•size
posNegTable â† XgcdâŒœËœ posNegNums
# Assert that the BÃ©zout coefficients are flipped between (x Xgcd y) and (y Xgcd x)
! âˆ§Â´âˆ§Ë identityMatrix âˆ¨ {(1 âŠ‘Â¨ ğ•©) = (2 âŠ‘Â¨ â‰ ğ•©)} posTable
! âˆ§Â´âˆ§Ë identityMatrix âˆ¨ {(1 âŠ‘Â¨ ğ•©) = (2 âŠ‘Â¨ â‰ ğ•©)} negTable

# Check that the BÃ©zout coefficients actually work
CheckBez â† {
   gâ€¿sâ€¿t â† ğ•©
   xâ€¿y â† ğ•¨
   g = (xÃ—s) + (yÃ—t)
}âš‡1

! âˆ§Â´âˆ§Ë (â‰âŒœËœ posNegNums) CheckBez posNegTable

# Mod Inverse
! 1 = ModInverse âŸ¨1, 2âŸ©
p â† 2039
CheckInverses â† {
  nums â† ZCross ğ•© 
  ! âˆ§Â´ ğ•© | nums Ã— ModInverseÂ¨ numsâˆ¾Â¨(â‰ nums)â¥Šğ•©
}
CheckInverses 2039
CheckInverses 7
CheckInverses 15 
CheckInverses size

# ZCross
! âŸ¨1, 2, 4, 5, 7, 8âŸ© â‰¡ ZCross 9
! âŸ¨1, 3, 5, 7, 9, 13, 15, 17, 19, 21âŸ© â‰¡ ZCross 22
! (1+â†•(p-1)) â‰¡ ZCross p
